<link rel="icon" href="https://raw.githubusercontent.com/SH20RAJ/DrivePlyr/main/drive-logo.png">
<title>DrivePlyr - Google Drive Proxy Video Player with Many Powerful HTML5 Players</title>
    
<!-- Meta Tags for SEO -->
<meta name="description" content="DrivePlyr is a Google Drive Proxy Video Player with Many Powerful HTML5 Players, Hidden ID, and Many Features. Play your videos from Google Drive with ease.">
<meta name="keywords" content="DrivePlyr, Google Drive, Proxy, Video Player, HTML5 Player, Hidden ID, Features">
<meta name="author" content="RTube">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://rabbi9827.github.io/video-player/">
<meta property="og:title" content="DrivePlyr - Google Drive Proxy Video Player with Many Powerful HTML5 Players">
<meta property="og:description" content="DrivePlyr is a Google Drive Proxy Video Player with Many Powerful HTML5 Players, Hidden ID, and Many Features. Play your videos from Google Drive with ease.">
<meta property="og:image" content="https://sh20raj.github.io/DrivePlyr/drive-logo.png">

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://rabbi9827.github.io/video-player/">
<meta property="twitter:title" content="DrivePlyr - Google Drive Proxy Video Player with Many Powerful HTML5 Players">
<meta property="twitter:description" content="DrivePlyr is a Google Drive Proxy Video Player with Many Powerful HTML5 Players, Hidden ID, and Many Features. Play your videos from Google Drive with ease.">
<meta property="twitter:image" content="https://sh20raj.github.io/DrivePlyr/drive-logo.png">

<!-- Other Meta Tags -->
<meta name="theme-color" content="#002333">
<meta name="robots" content="index, follow">

<!-- Google Fonts & Material Icons -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons|Material+Symbols+Outlined" rel="stylesheet">

<style>
@import url("https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap");

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: "Poppins", sans-serif;
}

video::cue {
  opacity: 0;
}

/* ========== NATIVE BANNER AD STYLES ========== */
/* বাম পাশের এড */
.native-ad-left {
  position: fixed;
  top: 0;
  left: 0;
  width: 50px;
  height: 100%;
  z-index: 9998;
  background: transparent;
  display: flex;
  justify-content: center;
  align-items: center;
}

/* ডান পাশের এড */
.native-ad-right {
  position: fixed;
  top: 0;
  right: 0;
  width: 50px;
  height: 100%;
  z-index: 9998;
  background: transparent;
  display: flex;
  justify-content: center;
  align-items: center;
}

/* পপআপ এড ওভারলে */
.native-ad-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.85);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
  opacity: 1;
  transition: opacity 0.3s ease;
}

.native-ad-overlay.hidden {
  opacity: 0;
  pointer-events: none;
}

/* পপআপ এড মোডাল */
.native-ad-modal {
  position: relative;
  max-width: 90%;
  max-height: 80%;
  background: #1a1a1a;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
  animation: adModalIn 0.3s ease;
  padding: 15px;
}

@keyframes adModalIn {
  from {
    transform: scale(0.8);
    opacity: 0;
  }
  to {
    transform: scale(1);
    opacity: 1;
  }
}

/* পপআপ ক্লোজ বাটন */
.native-ad-close {
  position: absolute;
  top: -10px;
  right: -10px;
  width: 30px;
  height: 30px;
  background: #333;
  border: 2px solid #fff;
  border-radius: 50%;
  color: #fff;
  font-size: 18px;
  cursor: pointer;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10;
  transition: background 0.2s, transform 0.2s;
}

.native-ad-close:hover {
  background: #ff4444;
  transform: scale(1.1);
}

/* Ad লেবেল */
.native-ad-label {
  position: absolute;
  top: 5px;
  left: 5px;
  background: rgba(0, 0, 0, 0.7);
  color: #ffae00;
  padding: 2px 8px;
  border-radius: 4px;
  font-size: 10px;
  font-weight: 500;
}

/* Ad container */
.ad-container {
  display: flex;
  justify-content: center;
  align-items: center;
}

/* ফুলস্ক্রিনে এড লুকান */
.video_player:fullscreen ~ .native-ad-left,
.video_player:fullscreen ~ .native-ad-right,
:fullscreen .native-ad-left,
:fullscreen .native-ad-right {
  display: none !important;
}

/* ========== VIDEO PLAYER STYLES ========== */
.caption_text {
  position: absolute;
  left: 50%;
  bottom: 10%;
  width: 90%;
  max-width: 90%;
  transform: translate(-50%, -50%);
  text-align: center;
  user-select: none;
  transition: bottom 0.3s;
  z-index: 10;
}

.caption_text.active {
  bottom: 0%;
}

.caption_text mark {
  background-color: #0000008f !important;
  color: #fff;
  padding: 2px 8px;
  border-radius: 4px;
}

.material-icons {
  user-select: none;
  -webkit-user-select: none;
  cursor: pointer;
}

body {
  background-color: #002333;
  margin: 0;
  padding: 0;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
}

.video_player {
  position: relative;
  width: 100%;
  height: 100vh;
  max-width: 100%;
  background: #000;
  overflow: hidden;
}

.video_player .loader {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 60px;
  height: 60px;
  border: 4px solid #fff;
  border-bottom-color: transparent;
  border-radius: 50%;
  z-index: 5;
  animation: animate 0.6s linear infinite;
  display: none;
}

@keyframes animate {
  0% { transform: translate(-50%, -50%) rotate(0deg); }
  100% { transform: translate(-50%, -50%) rotate(360deg); }
}

.video_player .main-video {
  position: relative;
  width: 100%;
  height: 100%;
  outline: none;
  object-fit: contain;
}

.video_player .progressAreaTime {
  position: absolute;
  left: calc(var(--x) + 11px);
  transform: translateX(-50%);
  bottom: 60px;
  min-width: 60px;
  text-align: center;
  white-space: nowrap;
  padding: 5px 10px;
  color: #fff;
  font-size: 14px;
  font-weight: 400;
  z-index: 15;
  display: none;
  background: rgba(0,0,0,0.7);
  border-radius: 4px;
}

.video_player .controls {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 50px;
  width: 100%;
  background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
  z-index: 10;
  transform: translateY(100%);
  transition: 0.3s;
  padding: 0px 10px;
}

.video_player .controls.active {
  transform: translateY(0);
}

.video_player .controls .progress-area {
  width: 100%;
  height: 5px;
  margin: auto;
  background: rgba(255,255,255,0.3);
  cursor: pointer;
  position: relative;
  border-radius: 3px;
}

.controls .progress-area .progress-bar {
  position: relative;
  width: 0%;
  background: linear-gradient(to right, #ffae00, #ff8c00);
  height: inherit;
  border-radius: inherit;
  cursor: pointer;
}

.controls .progress-area .progress-bar::before {
  content: "";
  position: absolute;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  right: -5px;
  top: 50%;
  transform: translateY(-50%);
  background: #ffae00;
  box-shadow: 0 0 5px rgba(255,174,0,0.5);
}

.controls .progress-area .bufferedBar {
  position: absolute;
  top: 0%;
  left: 0%;
  width: 100%;
  height: inherit;
  border-radius: inherit;
}

.controls .controls-list {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: nowrap;
  width: 97%;
  height: 46px;
  margin: 0 auto;
}

.controls .controls-list .controls-left,
.controls .controls-list .controls-right {
  display: flex;
  justify-content: center;
  align-items: center;
}

.controls .controls-left .timer {
  display: inline-block;
  font-size: 14px;
  white-space: nowrap;
  color: #fff;
  margin-left: 5px;
  text-align: center;
}

.controls .icon {
  display: inline-flex;
  justify-content: center;
  align-items: center;
  text-align: center;
  color: #fff;
  margin-left: 8px;
  margin-right: 5px;
}

.controls .icon .material-icons {
  font-size: 26px;
  color: #fff;
  cursor: pointer;
  transition: color 0.2s;
}

.controls .icon .material-icons:hover {
  color: #ffae00;
}

.controls .icon .material-icons.fast-rewind:active {
  transition: 0.2s;
  transform: rotate(-45deg);
}

.controls .icon .material-icons.fast-forward:active {
  transition: 0.2s;
  transform: rotate(45deg);
}

.controls .icon .volume_range {
  -webkit-appearance: none;
  appearance: none;
  width: 0px;
  height: 3px;
  background: #fff;
  cursor: pointer;
  outline: none;
  border: none;
  transition: 0.4s;
  border-radius: 3px;
}

.controls .icon .volume_range::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: #ffae00;
  opacity: 0;
  transition: 0.3s;
}

.controls .icon:hover .volume_range {
  display: inline-block;
  width: 60px;
}

.controls .icon:hover .volume_range::-webkit-slider-thumb {
  opacity: 1;
}

.controls-right .icon .auto-play {
  width: 30px;
  height: 10px;
  border-radius: 20px;
  position: relative;
  margin-right: 8px !important;
  background: #b6b6b6;
}

.controls-right .icon .auto-play::before {
  content: "\e034";
  position: absolute;
  left: -5px;
  top: 50%;
  transform: translateY(-50%);
  width: 17px;
  height: 17px;
  line-height: 17px;
  font-size: 14px;
  background: #727272;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
  border-radius: 50%;
  font-family: "Material Icons";
  transition: 0.2s;
}

.controls-right .icon .auto-play.active::before {
  content: "\e037";
  left: 15px;
  background: #ffae00;
}

.controls-right .icon .material-icons.settingsBtn {
  font-size: 24px;
  transition: 0.3s;
}

.controls-right .icon .settingsBtn.active {
  transform: rotate(45deg);
  color: #ffae00;
}

.video_player .settings {
  position: absolute;
  right: 10px;
  bottom: 62px;
  background: rgba(28, 28, 28, 0.95);
  width: 200px;
  max-height: 300px;
  height: auto;
  color: #fff;
  overflow-y: auto;
  z-index: 20;
  display: none;
  border-radius: 8px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.5);
}

.video_player .settings.active {
  display: block;
}

.video_player .settings > div > span {
  font-size: 14px;
  font-weight: 500;
  padding: 12px 20px;
  border-bottom: 1px solid rgba(255,255,255,0.1);
  display: flex;
  justify-content: space-between;
  align-items: center;
  white-space: nowrap;
}

.video_player .settings > div .icon {
  font-size: 14px;
  margin: 0 5px;
  cursor: pointer;
}

.video_player .settings > div ul {
  position: relative;
  list-style: none;
}

.video_player .settings > div ul li {
  position: relative;
  width: 100%;
  cursor: pointer;
  text-align: left;
  padding: 10px 20px 10px 35px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 14px;
  transition: background 0.2s;
}

.video_player .settings > div ul li:hover {
  background: rgba(255,174,0,0.15);
}

.video_player .settings > div ul li.active::before {
  content: "\e876";
  font-family: "Material Icons";
  position: absolute;
  left: 10px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 16px;
  color: #ffae00;
}

.video_player .settings::-webkit-scrollbar {
  width: 6px;
  background: transparent;
}

.video_player .settings::-webkit-scrollbar-thumb {
  background: rgba(255,255,255,0.3);
  border-radius: 10px;
}

/* Responsive */
@media (max-width: 768px) {
  .video_player {
    width: 100%;
    border-radius: 0;
  }
  
  .native-ad-left,
  .native-ad-right {
    width: 40px;
  }
}

@media (max-width: 430px) {
  .controls .icon {
    margin-left: 3px;
    margin-right: 3px;
  }
  
  .controls .icon .material-icons {
    font-size: 22px;
  }

  .volume, .volume_range, .auto-play, .picture_in_picutre {
    display: none !important;
  }
  
  .controls .controls-left .timer {
    font-size: 12px;
  }
}
</style>

<!-- ========== NATIVE BANNER ADS ========== -->

<!-- বাম পাশের এড (Left Side Ad) -->
<div class="native-ad-left" id="native-ad-left">
  <div class="ad-container" id="ad-container-left">
    <!-- 
    ===== আপনার LEFT SIDE AD কোড এখানে বসান =====
    Adsterra থেকে কোড কপি করে এখানে পেস্ট করুন:
    
    <script async="async" data-cfasync="false" src="https://pl28245096.effectivegatecpm.com/e3e3845182f115c940268442dba69c39/invoke.js"></script>
    <div id="container-e3e3845182f115c940268442dba69c39"></div>
    -->
  </div>
</div>

<!-- ডান পাশের এড (Right Side Ad) -->
<div class="native-ad-right" id="native-ad-right">
  <div class="ad-container" id="ad-container-right">
    <!-- 
    ===== আপনার RIGHT SIDE AD কোড এখানে বসান =====
    Adsterra থেকে কোড কপি করে এখানে পেস্ট করুন:
    
    <script async="async" data-cfasync="false" src="https://pl28245096.effectivegatecpm.com/e3e3845182f115c940268442dba69c39/invoke.js"></script>
    <div id="container-e3e3845182f115c940268442dba69c39"></div>
    -->
  </div>
</div>

<!-- পপআপ এড (Center Popup Ad) -->
<div class="native-ad-overlay" id="native-ad-overlay">
  <div class="native-ad-modal">
    <span class="native-ad-label">Ad</span>
    <button class="native-ad-close" id="native-ad-close">&times;</button>
    <div class="ad-container" id="ad-container-popup">
      <!-- 
      ===== আপনার POPUP AD কোড এখানে বসান =====
      Adsterra থেকে কোড কপি করে এখানে পেস্ট করুন:
      
      <script async="async" data-cfasync="false" src="https://pl28245096.effectivegatecpm.com/e3e3845182f115c940268442dba69c39/invoke.js"></script>
      <div id="container-e3e3845182f115c940268442dba69c39"></div>
      -->
    </div>
  </div>
</div>

<!-- ========== VIDEO PLAYER ========== -->
<div class="video_player">
  <div class="loader"></div>
  <video class="main-video" id="main-video" preload="metadata"></video>
  <p class="caption_text"></p>
  <div class="progressAreaTime">0:00</div>
  
  <div class="controls active">
    <div class="progress-area">
      <canvas class="bufferedBar"></canvas>
      <div class="progress-bar"><span></span></div>
    </div>

    <div class="controls-list">
      <div class="controls-left">
        <span class="icon">
          <i class="material-icons fast-rewind">replay_10</i>
        </span>
        <span class="icon">
          <i class="material-icons play_pause">play_arrow</i>
        </span>
        <span class="icon">
          <i class="material-icons fast-forward">forward_10</i>
        </span>
        <span class="icon">
          <i class="material-icons volume">volume_up</i>
          <input type="range" min="0" max="100" value="100" class="volume_range" />
        </span>
        <div class="timer">
          <span class="current">0:00</span> / <span class="duration">0:00</span>
        </div>
      </div>

      <div class="controls-right">
        <span class="icon">
          <i class="material-icons auto-play"></i>
        </span>
        <span class="icon">
          <i class="material-icons settingsBtn">settings</i>
        </span>
        <span class="icon">
          <i class="material-icons picture_in_picutre">picture_in_picture_alt</i>
        </span>
        <span class="icon">
          <i class="material-icons fullscreen">fullscreen</i>
        </span>
      </div>
    </div>
  </div>

  <div class="settings">
    <div data-label="settingHome">
      <ul>
        <li data-label="speed">
          <span>Speed</span>
          <span class="material-symbols-outlined icon">arrow_forward_ios</span>
        </li>
      </ul>
    </div>
    <div class="playback" data-label="speed" hidden>
      <span>
        <i class="material-symbols-outlined icon back_arrow" data-label="settingHome">arrow_back</i>
        <span>Playback Speed</span>
      </span>
      <ul>
        <li data-speed="0.25">0.25x</li>
        <li data-speed="0.5">0.5x</li>
        <li data-speed="0.75">0.75x</li>
        <li data-speed="1" class="active">Normal</li>
        <li data-speed="1.25">1.25x</li>
        <li data-speed="1.5">1.5x</li>
        <li data-speed="1.75">1.75x</li>
        <li data-speed="2">2x</li>
      </ul>
    </div>
  </div>
</div>

<script>
  // ========== NATIVE BANNER AD CONFIGURATION ==========
  // এই সেটিংস পরিবর্তন করে এড চালু/বন্ধ করুন
  const NATIVE_AD_CONFIG = {
    showLeftAd: true,       // বাম পাশের এড (true = দেখাবে, false = দেখাবে না)
    showRightAd: true,      // ডান পাশের এড
    showPopupAd: true,      // পপআপ এড (ভিডিও প্লে করার আগে)
    popupShowOnEveryVisit: true  // true = প্রতিবার দেখাবে, false = সেশনে একবারই
  };

  // Initialize Native Ads
  function initNativeAds() {
    // Left Ad
    const leftAd = document.getElementById('native-ad-left');
    if (!NATIVE_AD_CONFIG.showLeftAd) {
      leftAd.style.display = 'none';
    }
    
    // Right Ad
    const rightAd = document.getElementById('native-ad-right');
    if (!NATIVE_AD_CONFIG.showRightAd) {
      rightAd.style.display = 'none';
    }
    
    // Popup Ad
    const overlay = document.getElementById('native-ad-overlay');
    const closeBtn = document.getElementById('native-ad-close');
    
    if (!NATIVE_AD_CONFIG.showPopupAd) {
      overlay.classList.add('hidden');
    } else {
      if (!NATIVE_AD_CONFIG.popupShowOnEveryVisit) {
        const adShown = sessionStorage.getItem('native_ad_popup_shown');
        if (adShown) {
          overlay.classList.add('hidden');
        }
      }
      
      // Close button click
      closeBtn.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        overlay.classList.add('hidden');
        sessionStorage.setItem('native_ad_popup_shown', 'true');
      });
      
      // Click outside to close
      overlay.addEventListener('click', function(e) {
        if (e.target === overlay) {
          overlay.classList.add('hidden');
          sessionStorage.setItem('native_ad_popup_shown', 'true');
        }
      });
    }
  }

  // Google API Keys
  var apikeys = [
    'AIzaSyCt3DULzE2trDJhfFUosWZT-3GEObbMqVU',
    'AIzaSyCsbx8BSyLwkw6XX6Lg5OF1U0HNtI9VmCY',
    'AIzaSyATjR8DbYGha0Z2U84gPVT0dxROp7UdWy8',
    'AIzaSyBLMJAT6oqTZxAMsCsMjXzoo4lkJL4MmfM',
    'AIzaSyCIY6fomcJxOt0XQ_naa1rzfd5wlOMGKDY',
    'AIzaSyDCLkAwFkagtt077kgXw1HfmYGx-VLkvt8'
  ];
  var apikey = apikeys[Math.floor(Math.random() * apikeys.length)];

  function getparam(a, e) {
    return e || (e = window.location.href), new URL(e).searchParams.get(a);
  }

  // Elements
  const video_player = document.querySelector('.video_player');
  const mainVideo = document.getElementById('main-video');
  const progressAreaTime = document.querySelector('.progressAreaTime');
  const controls = document.querySelector('.controls');
  const progressArea = document.querySelector('.progress-area');
  const bufferedBar = document.querySelector('.bufferedBar');
  const progress_Bar = document.querySelector('.progress-bar');
  const fast_rewind = document.querySelector('.fast-rewind');
  const play_pause = document.querySelector('.play_pause');
  const fast_forward = document.querySelector('.fast-forward');
  const volume = document.querySelector('.volume');
  const volume_range = document.querySelector('.volume_range');
  const current = document.querySelector('.current');
  const totalDuration = document.querySelector('.duration');
  const auto_play = document.querySelector('.auto-play');
  const settingsBtn = document.querySelector('.settingsBtn');
  const picture_in_picutre = document.querySelector('.picture_in_picutre');
  const fullscreen = document.querySelector('.fullscreen');
  const settings = document.querySelector('.settings');
  const settingHome = document.querySelectorAll(".settings [data-label='settingHome'] > ul > li");
  const playback = document.querySelectorAll('.playback li');
  const loader = document.querySelector('.loader');
  const settingDivs = document.querySelectorAll('.settings > div');
  const settingBack = document.querySelectorAll('.settings > div .back_arrow');

  // Initialize Native Ads
  initNativeAds();

  // Load video from Google Drive
  if (getparam('id')) {
    try {
      let json = JSON.parse(atob(getparam('id')));
      let driveid = json.id;
      mainVideo.src = `https://www.googleapis.com/drive/v3/files/${driveid}?alt=media&key=${apikey}`;
      mainVideo.poster = 'https://lh3.googleusercontent.com/d/' + driveid;
    } catch (e) {
      console.error('Invalid video ID');
      mainVideo.src = 'https://bit.ly/bbsamplevideo';
    }
  } else {
    mainVideo.src = 'https://bit.ly/bbsamplevideo';
  }

  // Play/Pause
  function playVideo() {
    play_pause.innerHTML = 'pause';
    play_pause.title = 'Pause';
    video_player.classList.add('paused');
    mainVideo.play();
  }

  function pauseVideo() {
    play_pause.innerHTML = 'play_arrow';
    play_pause.title = 'Play';
    video_player.classList.remove('paused');
    mainVideo.pause();
  }

  play_pause.addEventListener('click', () => {
    video_player.classList.contains('paused') ? pauseVideo() : playVideo();
  });

  mainVideo.addEventListener('play', playVideo);
  mainVideo.addEventListener('pause', pauseVideo);

  // Click on video to play/pause
  mainVideo.addEventListener('click', () => {
    video_player.classList.contains('paused') ? pauseVideo() : playVideo();
  });

  // Fast rewind/forward
  fast_rewind.addEventListener('click', () => { mainVideo.currentTime -= 10; });
  fast_forward.addEventListener('click', () => { mainVideo.currentTime += 10; });

  // Duration
  mainVideo.addEventListener('loadeddata', (e) => {
    const duration = e.target.duration;
    const min = Math.floor(duration / 60);
    let sec = Math.floor(duration % 60);
    sec = sec < 10 ? '0' + sec : sec;
    totalDuration.innerHTML = `${min}:${sec}`;
  });

  // Time update
  mainVideo.addEventListener('timeupdate', (e) => {
    const currentTime = e.target.currentTime;
    const duration = e.target.duration;
    const min = Math.floor(currentTime / 60);
    let sec = Math.floor(currentTime % 60);
    sec = sec < 10 ? '0' + sec : sec;
    current.innerHTML = `${min}:${sec}`;
    const progressWidth = (currentTime / duration) * 100;
    progress_Bar.style.width = `${progressWidth}%`;
  });

  // Progress bar click
  progressArea.addEventListener('pointerdown', (e) => {
    progressArea.setPointerCapture(e.pointerId);
    setTimelinePosition(e);
    progressArea.addEventListener('pointermove', setTimelinePosition);
    progressArea.addEventListener('pointerup', () => {
      progressArea.removeEventListener('pointermove', setTimelinePosition);
    });
  });

  function setTimelinePosition(e) {
    const width = progressArea.clientWidth;
    const clickX = e.offsetX;
    mainVideo.currentTime = (clickX / width) * mainVideo.duration;
  }

  // Buffered bar
  function drawProgress(canvas, buffered, duration) {
    const ctx = canvas.getContext('2d');
    ctx.fillStyle = 'rgba(255,255,255,0.4)';
    const height = canvas.height;
    const width = canvas.width;
    ctx.clearRect(0, 0, width, height);
    for (let i = 0; i < buffered.length; i++) {
      const start = (buffered.start(i) / duration) * width;
      const end = (buffered.end(i) / duration) * width;
      ctx.fillRect(start, 0, end - start, height);
    }
  }

  mainVideo.addEventListener('progress', () => {
    drawProgress(bufferedBar, mainVideo.buffered, mainVideo.duration);
  });

  // Loader
  mainVideo.addEventListener('waiting', () => { loader.style.display = 'block'; });
  mainVideo.addEventListener('canplay', () => { loader.style.display = 'none'; });

  // Volume
  function changeVolume() {
    mainVideo.volume = volume_range.value / 100;
    if (volume_range.value == 0) {
      volume.innerHTML = 'volume_off';
    } else if (volume_range.value < 40) {
      volume.innerHTML = 'volume_down';
    } else {
      volume.innerHTML = 'volume_up';
    }
  }

  volume_range.addEventListener('input', changeVolume);
  volume.addEventListener('click', () => {
    if (volume_range.value == 0) {
      volume_range.value = 80;
      mainVideo.volume = 0.8;
      volume.innerHTML = 'volume_up';
    } else {
      volume_range.value = 0;
      mainVideo.volume = 0;
      volume.innerHTML = 'volume_off';
    }
  });

  // Progress area time display
  progressArea.addEventListener('mousemove', (e) => {
    const width = progressArea.clientWidth;
    let x = e.offsetX;
    const time = Math.floor((x / width) * mainVideo.duration);
    const min = Math.floor(time / 60);
    let sec = Math.floor(time % 60);
    sec = sec < 10 ? '0' + sec : sec;
    progressAreaTime.style.setProperty('--x', `${x}px`);
    progressAreaTime.style.display = 'block';
    progressAreaTime.innerHTML = `${min}:${sec}`;
  });

  progressArea.addEventListener('mouseleave', () => {
    progressAreaTime.style.display = 'none';
  });

  // Auto play
  auto_play.addEventListener('click', () => {
    auto_play.classList.toggle('active');
    auto_play.title = auto_play.classList.contains('active') ? 'Autoplay ON' : 'Autoplay OFF';
  });

  mainVideo.addEventListener('ended', () => {
    if (auto_play.classList.contains('active')) {
      mainVideo.currentTime = 0;
      playVideo();
    } else {
      play_pause.innerHTML = 'replay';
      play_pause.title = 'Replay';
    }
  });

  // Picture in Picture
  picture_in_picutre.addEventListener('click', () => {
    mainVideo.requestPictureInPicture();
  });

  // Fullscreen
  fullscreen.addEventListener('click', () => {
    if (!video_player.classList.contains('openFullScreen')) {
      video_player.classList.add('openFullScreen');
      fullscreen.innerHTML = 'fullscreen_exit';
      video_player.requestFullscreen();
    } else {
      video_player.classList.remove('openFullScreen');
      fullscreen.innerHTML = 'fullscreen';
      document.exitFullscreen();
    }
  });

  // Settings
  settingsBtn.addEventListener('click', () => {
    settings.classList.toggle('active');
    settingsBtn.classList.toggle('active');
  });

  // Playback speed
  playback.forEach((item) => {
    item.addEventListener('click', () => {
      playback.forEach(i => i.classList.remove('active'));
      item.classList.add('active');
      mainVideo.playbackRate = item.getAttribute('data-speed');
    });
  });

  // Settings navigation
  settingBack.forEach((item) => {
    item.addEventListener('click', (e) => {
      const label = e.target.getAttribute('data-label');
      settingDivs.forEach(div => {
        div.getAttribute('data-label') === label ? div.removeAttribute('hidden') : div.setAttribute('hidden', '');
      });
    });
  });

  settingHome.forEach((item) => {
    item.addEventListener('click', (e) => {
      const label = e.target.getAttribute('data-label');
      settingDivs.forEach(div => {
        div.getAttribute('data-label') === label ? div.removeAttribute('hidden') : div.setAttribute('hidden', '');
      });
    });
  });

  // Hide controls
  let timer;
  const hideControls = () => {
    if (mainVideo.paused) return;
    timer = setTimeout(() => {
      if (!settingsBtn.classList.contains('active')) {
        controls.classList.remove('active');
      }
    }, 3000);
  };
  hideControls();

  video_player.addEventListener('mousemove', () => {
    controls.classList.add('active');
    clearTimeout(timer);
    hideControls();
  });

  // Prevent right-click
  mainVideo.addEventListener('contextmenu', (e) => e.preventDefault());

  // Auto-rotate for fullscreen
  function rotateToLandscape() {
    if (screen.orientation && screen.orientation.lock) {
      screen.orientation.lock('landscape-primary').catch(() => {});
    }
  }

  function unlockOrientation() {
    if (screen.orientation && screen.orientation.unlock) {
      screen.orientation.unlock();
    }
  }

  document.addEventListener('fullscreenchange', () => {
    const isFullscreen = document.fullscreenElement;
    if (isFullscreen) {
      setTimeout(rotateToLandscape, 100);
    } else {
      setTimeout(unlockOrientation, 100);
      video_player.classList.remove('openFullScreen');
      fullscreen.innerHTML = 'fullscreen';
    }
  });

  // Keyboard shortcuts
  document.addEventListener('keydown', (e) => {
    switch(e.key) {
      case ' ':
      case 'k':
        e.preventDefault();
        video_player.classList.contains('paused') ? pauseVideo() : playVideo();
        break;
      case 'ArrowLeft':
        mainVideo.currentTime -= 10;
        break;
      case 'ArrowRight':
        mainVideo.currentTime += 10;
        break;
      case 'ArrowUp':
        e.preventDefault();
        mainVideo.volume = Math.min(1, mainVideo.volume + 0.1);
        volume_range.value = mainVideo.volume * 100;
        changeVolume();
        break;
      case 'ArrowDown':
        e.preventDefault();
        mainVideo.volume = Math.max(0, mainVideo.volume - 0.1);
        volume_range.value = mainVideo.volume * 100;
        changeVolume();
        break;
      case 'f':
        fullscreen.click();
        break;
      case 'm':
        volume.click();
        break;
    }
  });
</script>
